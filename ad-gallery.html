<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Manage Gallery</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
<div class="container mt-4">
    <h2 class="text-center mb-4">üõ†Ô∏è Manage Gallery</h2>

    <form id="uploadForm" class="mb-4">
        <div class="input-group">
            <input type="file" id="fileInput" class="form-control" required>
            <button class="btn btn-primary" type="submit">Upload</button>
        </div>
    </form>
        <div class="text-end mb-3">
        <a href="photographer-dashboard.html" class="btn btn-secondary">
            <i class="bi bi-arrow-left"></i> Back to Dashboard
        </a>
    </div>

    <form id="uploadForm" class="mb-4">

    <div id="imagesContainer" class="row g-3"></div>
</div>

<script>
const API = "http://localhost:9000/api/gallery";

function loadImages() {
    fetch(API)
        .then(res => res.json())
        .then(images => {
            const container = document.getElementById("imagesContainer");
            container.innerHTML = "";
            images.forEach(img => {
                const imgUrl = `${API}/${img.id}`;
                const col = document.createElement("div");
                col.classList.add("col-md-3");
                col.innerHTML = `
                    <div class="card shadow-sm">
                        <img src="${imgUrl}" class="card-img-top" alt="${img.name}">
                        <div class="card-body text-center">
                            <p>${img.name}</p>
                            <button class="btn btn-danger btn-sm" onclick="deleteImage(${img.id})">Delete</button>
                        </div>
                    </div>`;
                container.appendChild(col);
            });
        });
}

document.getElementById("uploadForm").addEventListener("submit", e => {
    e.preventDefault();
    const file = document.getElementById("fileInput").files[0];
    const formData = new FormData();
    formData.append("file", file);
    fetch(`${API}/upload`, { method: "POST", body: formData })
        .then(() => loadImages());
});

function deleteImage(id) {
    fetch(`${API}/${id}`, { method: "DELETE" })
        .then(() => loadImages());
}

loadImages();
</script>
</body>
</html>
